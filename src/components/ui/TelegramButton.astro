---
import Button from "./Button.astro";
import TelegramIcon from "./TelegramIcon.astro";

interface Props {
  variant?: "primary" | "secondary" | "ghost";
  type?: "bot" | "channel" | "user" | "custom";
  username?: string; 
  startParam?: string; 
  href?: string; 
  class?: string;
  size?: number;
}

const {
  variant = "primary",
  type = "channel",
  username = "ELDORADOFX",
  startParam,
  href,
  class: className = "",
  size = 18
} = Astro.props;

let finalHref = "";

if (type === "custom" && href) {
  finalHref = href;
} else {
  const baseUrl = `https://t.me/${username}`;
  
  if (type === "bot" && startParam) {
    finalHref = `${baseUrl}?start=${startParam}`;
  } else {
    finalHref = baseUrl;
  }
}

const typeStyles = {
  channel: "bg-gradient-to-b from-[#e5c46a] to-[var(--color-gold)] text-black border-0 shadow-[0_4px_15px_rgba(185,138,37,0.25)] hover:shadow-[0_4px_20px_rgba(185,138,37,0.35)]",
  bot: "bg-gradient-to-b from-[#38bdf8] to-[#0284c7] text-white border-0 shadow-[0_4px_15px_rgba(56,189,248,0.25)] hover:shadow-[0_4px_20px_rgba(56,189,248,0.35)]",
  user: "border border-white/20 bg-white/[0.02] text-white hover:bg-white/[0.08] hover:border-white/30 shadow-none backdrop-blur-md",
  custom: ""
};

const activeStyle = type !== "custom" ? typeStyles[type] : "";
const baseVariant = type === "custom" ? variant : "ghost";
---

<Button 
  variant={baseVariant} 
  href={finalHref} 
  class:list={[
    "group gap-2 overflow-hidden flex items-center justify-center transition-all duration-300 hover:scale-[1.02]",
    activeStyle,
    className
  ]}
>
  <slot>
    {type === 'channel' ? 'Join Channel' : type === 'bot' ? 'Start Bot' : 'Contact Support'}
  </slot>
  
  <div class="transition-transform duration-300 -translate-y-0.5 group-hover:-translate-y-1 group-hover:translate-x-1">
    <TelegramIcon size={size} />
  </div>
</Button>