---
import Section from "../../components/ui/Section.astro";
import Container from "../../components/ui/Container.astro";
import Heading from "../../components/ui/Heading.astro";
import Text from "../../components/ui/Text.astro";
import Badge from "../../components/ui/Badge.astro";
import InstagramIcon from "../ui/InstagramIcon.astro";
import TelegramIcon from "../ui/TelegramIcon.astro";
import BentoCard from "../../components/ui/BentoCard.astro";
import { useTranslations, getLanguageFromPath } from "../../i18n/utils";

interface ImageItem {
  src: string;
  link?: string;
  badge?: "ig" | "tl";
}

interface Props {
  badge?: string;
  title: string;
  description: string;
  images?: ImageItem[];
  mainLabel?: string;
  disclaimer?: string;
  icon?: "ig" | "tl" | null;
}

const lang = getLanguageFromPath(Astro.url.pathname);
const t = useTranslations(lang);

const {
  badge = t("contact.socialFeed"),
  title,
  description,
  images = [],
  mainLabel,
  disclaimer,
  icon = null
} = Astro.props;

const [mainItem, ...smallItems] = images;
---

<Section class="relative py-24 overflow-hidden reveal fade">
  <Container>

    {/* HEADER */}
    <div class="flex flex-col items-center text-center mb-16">
      <Badge variant="gold" class="mb-4 flex items-center justify-center mx-auto gap-2">
        {badge} 
        {icon === 'ig' && <InstagramIcon class="w-4 h-4 -mt-0.5" />}
        {icon === 'tl' && <TelegramIcon class="w-4 h-4 -mt-0.5" />}
      </Badge>

      <Heading level={2} class="mb-4">
        {title}
      </Heading>

      <Text muted class="max-w-2xl">
        {description}
      </Text>
    </div>

    {/* BENTO GRID */}
    <div class="relative grid grid-cols-1 md:grid-cols-4 md:grid-rows-2 gap-6 h-194">
      
      {/* GLOW EFFECT */}
      <div class="pointer-events-none absolute -inset-24 bg-[radial-gradient(ellipse_at_center,rgba(255,215,120,0.12),transparent_65%)] blur-[120px]"></div>

      {/* 1. CARTA PRINCIPAL */}
      {mainItem && (
        <BentoCard
          src={mainItem.src}
          link={mainItem.link}
          badge={mainItem.badge}
          label={mainLabel}
          class="md:col-span-2 md:row-span-2" 
        />
      )}

      {/* 2. CARTAS PEQUEÑAS (Iteración limpia) */}
      {smallItems.map((item) => (
        <BentoCard
          src={item.src}
          link={item.link}
          badge={item.badge}
        />
      ))}
    </div>

    {/* DISCLAIMER */}
    {disclaimer && (
      <div class="mt-10 flex justify-center">
        <Text muted class="text-xs max-w-xl text-center">
          {disclaimer}
        </Text>
      </div>
    )}

  </Container>
</Section>